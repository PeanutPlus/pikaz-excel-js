<!--
 * @Author: zouzheng
 * @Date: 2020-05-07 14:57:19
 * @LastEditors: zouzheng
 * @LastEditTime: 2021-01-09 18:26:15
 * @Description: 这是exportDemo组件（页面）
 -->
<template>
  <div class="export-demo">
    <!-- 点击导出 -->
    <excel-export
      :bookType="bookType"
      :filename="filename"
      :sheet="sheet"
      :on-error="onError"
    >
      <div class="export-btn">点击导出</div>
    </excel-export>
    <!-- 手动导出 -->
    <excel-export
      :bookType="bookType"
      :filename="filename"
      :sheet="sheet"
      :on-error="onError"
      :manual="true"
      ref="excelExport"
    >
    </excel-export>
    <div class="export-btn" @click="exportTable">点击异步导出</div>
  </div>
</template>

<script>
import { ExcelExport } from "../../plugin";
export default {
  props: {},
  components: { ExcelExport },
  data() {
    return {
      bookType: "xlsx",
      filename: "export-demo",
      sheet: [
        {
          title: "插件信息",
          tHeader: ["作者", "语言", "插件名称", "插件用途"],
          table: [
            {
              author: "pikaz",
              language: "javascript",
              name: "pikaz-excel-js",
              application: "excel的导入导出",
            },
          ],
          keys: ["author", "language", "name", "application"],
          sheetName: "插件信息",
          cellStyle: [
            {
              cell: "A1",
              font: {
                sz: 14,
                color: { rgb: "ffffff" },
                bold: true,
              },
              fill: {
                fgColor: { rgb: "ff7e00" },
              },
            },
          ],
        },
        {
          title: "插件信息2",
          multiHeader: [
            ["基础信息", "", "", "详细信息"],
            ["作者", "语言", "插件名称", "插件用途"],
          ],
          table: [
            {
              author: "pikaz",
              language: "javascript",
              name: "pikaz-excel-js",
              application: "excel的导入导出",
            },
          ],
          keys: ["author", "language", "name", "application"],
          merges: ["A2:C2"],
          colWidth: [16, 16, 16, 20],
          sheetName: "插件信息2",
          globalStyle: {
            font: {
              color: { rgb: "ff7e00" },
            },
          },
          cellStyle: [
            {
              cell: "A1",
              font: {
                name: "宋体",
                sz: 14,
                color: { rgb: "ffffff" },
                bold: true,
              },
              fill: {
                fgColor: { rgb: "ff7e00" },
              },
            },
          ],
        },
      ],
    };
  },
  created() {},
  mounted() {},
  methods: {
    /**
     * @name: 导出错误
     * @param {String} err/错误信息
     * @return:
     */
    onError(err) {
      console.log(err);
    },
    /**
     * @name: 异步导出
     * @param {type}
     * @return:
     */
    exportTable() {
      // 发出请求获取数据
      this.getData().then((res) => {
        // 请求获取数据到的数据按参数格式赋值给sheet参数
        this.sheet = res;
        // 调用导出函数
        this.$refs.excelExport.pikaExportExcel();
      });
    },
    /**
     * @description:模拟异步请求获取数据
     * @param {*}
     * @return {*}
     */
    getData() {
      return new Promise((resolve, reject) => {
        setTimeout(() => {
          resolve(this.sheet);
        }, 100);
      });
    },
  },
  computed: {},
  watch: {},
};
</script>

<style scoped>
.export-demo {
  display: flex;
  justify-content: space-between;
}
.export-btn {
  display: flex;
  justify-content: center;
  align-items: center;
  background: #ff7e00;
  border-radius: 4px;
  color: #ffffff;
  cursor: pointer;
  padding: 8px;
}
.code {
  margin-left: 100px;
  width: calc(100% - 100px);
  background: #eee;
}
</style>
